
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
        <meta name="author" content="Terracenter">
      
      
      
        <link rel="prev" href="../api/">
      
      
        <link rel="next" href="../docs/introduccion/">
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.17">
    
    
      
        <title>Integración de AbuseIPDB con Fail2Ban - La Biblioteca de Humanbyte</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.bcfcd587.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      
  


  
  

<script id="__analytics">function __md_analytics(){function n(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],n("js",new Date),n("config","G-5T8Q8F61MQ"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){this.value&&n("event","search",{search_term:this.value})}),document$.subscribe(function(){var a=document.forms.feedback;if(void 0!==a)for(var e of a.querySelectorAll("[type=submit]"))e.addEventListener("click",function(e){e.preventDefault();var t=document.location.pathname,e=this.getAttribute("data-md-value");n("event","feedback",{page:t,data:e}),a.firstElementChild.disabled=!0;e=a.querySelector(".md-feedback__note [data-md-value='"+e+"']");e&&(e.hidden=!1)}),a.hidden=!1}),location$.subscribe(function(e){n("config","G-5T8Q8F61MQ",{page_path:e.pathname})})});var e=document.createElement("script");e.async=!0,e.src="https://www.googletagmanager.com/gtag/js?id=G-5T8Q8F61MQ",document.getElementById("__analytics").insertAdjacentElement("afterEnd",e)}</script>
  
    <script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
  

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="tealblue-grey" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#integracion-de-abuseipdb-con-fail2ban" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../../.." title="La Biblioteca de Humanbyte" class="md-header__button md-logo" aria-label="La Biblioteca de Humanbyte" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            La Biblioteca de Humanbyte
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Integración de AbuseIPDB con Fail2Ban
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="tealblue-grey" data-md-color-accent="purple"  aria-label="Modo oscuro"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Modo oscuro" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6zm0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4zM7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="blue" data-md-color-accent="lime"  aria-label="Modo claro"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Modo claro" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/terracenter/biblioteca" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../.." class="md-tabs__link">
        
  
    
  
  Bienvenidos a la Biblioteca

      </a>
    </li>
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Cursos/Linux/NDG_Linux_Essentias_Spanish/Modulo_01/Introduccion_a_Linux/1.1.Introduccion/" class="md-tabs__link">
          
  
    
  
  Cursos

        </a>
      </li>
    
  

    
  

    
  

    
  

    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../../" class="md-tabs__link">
          
  
    
  
  Documentos

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Libros/" class="md-tabs__link">
          
  
    
  
  Libros

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../../Manuales/Asterisk/Instalacion_de_Asterisk_en_Debian_12/" class="md-tabs__link">
          
  
    
  
  Manuales

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../.." title="La Biblioteca de Humanbyte" class="md-nav__button md-logo" aria-label="La Biblioteca de Humanbyte" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    La Biblioteca de Humanbyte
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/terracenter/biblioteca" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bienvenidos a la Biblioteca
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    
  
  
    
  
  
    
  
  
    <a href="../../../../Cursos/Linux/NDG_Linux_Essentias_Spanish/Modulo_01/Introduccion_a_Linux/1.1.Introduccion/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Cursos
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

  

  

  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Documentos
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Documentos
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../Asterisk/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Asterisk
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../../../Base_de_Datos/Postgresql/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Base de Datos
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../FreeRADIUS/0.%20Introducci%C3%B3n/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    FreeRADIUS
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../../../Markdown/Material_for_MkDocs/01.Instalacion/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Markdown
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../../../Monitoreo/Log%20Serer/rsyslog%20Server/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Monitoreo
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7" checked>
        
          
          <label class="md-nav__link" for="__nav_3_7" id="__nav_3_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Seguridad
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_7_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_7">
            <span class="md-nav__icon md-icon"></span>
            Seguridad
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_7_1" checked>
        
          
          <label class="md-nav__link" for="__nav_3_7_1" id="__nav_3_7_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    abuseIPDB
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="3" aria-labelledby="__nav_3_7_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_7_1">
            <span class="md-nav__icon md-icon"></span>
            abuseIPDB
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Documentación de la API - AbuseIPDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Integración de AbuseIPDB con Fail2Ban
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Integración de AbuseIPDB con Fail2Ban
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#denuncia-automatica-de-ips-maliciosas" class="md-nav__link">
    <span class="md-ellipsis">
      Denuncia automática de IPs maliciosas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tutorial-de-integracion-de-abuseipdb-fail2ban" class="md-nav__link">
    <span class="md-ellipsis">
      Tutorial de integración de AbuseIPDB + Fail2Ban
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requisitos-previos-antes-de-empezar-este-tutorial" class="md-nav__link">
    <span class="md-ellipsis">
      Requisitos previos - Antes de empezar este tutorial
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compruebe-que-la-accion-de-denuncia-de-abusos-de-fail2banipdb-esta-instalada" class="md-nav__link">
    <span class="md-ellipsis">
      Compruebe que la acción de denuncia de abusos de Fail2BanIPDB está instalada
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Compruebe que la acción de denuncia de abusos de Fail2BanIPDB está instalada">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#que-hara-la-accion-abuseipdb" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Qué hará la acción AbuseIPDB?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#activar-la-accion-de-denuncia-de-abuseipdb" class="md-nav__link">
    <span class="md-ellipsis">
      Activar la acción de denuncia de AbuseIPDB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solucion-de-problemas" class="md-nav__link">
    <span class="md-ellipsis">
      Solución de problemas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solución de problemas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#errores-en-la-clave-y-los-parametros-de-la-api" class="md-nav__link">
    <span class="md-ellipsis">
      Errores en la clave y los parámetros de la API:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limites-y-estrangulamiento-de-la-api" class="md-nav__link">
    <span class="md-ellipsis">
      Límites y estrangulamiento de la API:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../docs/introduccion/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Docs
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../../../Libros/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Libros
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    
  
  
    <a href="../../../../Manuales/Asterisk/Instalacion_de_Asterisk_en_Debian_12/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Manuales
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

  

      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#denuncia-automatica-de-ips-maliciosas" class="md-nav__link">
    <span class="md-ellipsis">
      Denuncia automática de IPs maliciosas
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tutorial-de-integracion-de-abuseipdb-fail2ban" class="md-nav__link">
    <span class="md-ellipsis">
      Tutorial de integración de AbuseIPDB + Fail2Ban
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#requisitos-previos-antes-de-empezar-este-tutorial" class="md-nav__link">
    <span class="md-ellipsis">
      Requisitos previos - Antes de empezar este tutorial
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#compruebe-que-la-accion-de-denuncia-de-abusos-de-fail2banipdb-esta-instalada" class="md-nav__link">
    <span class="md-ellipsis">
      Compruebe que la acción de denuncia de abusos de Fail2BanIPDB está instalada
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Compruebe que la acción de denuncia de abusos de Fail2BanIPDB está instalada">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#que-hara-la-accion-abuseipdb" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Qué hará la acción AbuseIPDB?
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#activar-la-accion-de-denuncia-de-abuseipdb" class="md-nav__link">
    <span class="md-ellipsis">
      Activar la acción de denuncia de AbuseIPDB
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#solucion-de-problemas" class="md-nav__link">
    <span class="md-ellipsis">
      Solución de problemas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Solución de problemas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#errores-en-la-clave-y-los-parametros-de-la-api" class="md-nav__link">
    <span class="md-ellipsis">
      Errores en la clave y los parámetros de la API:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#limites-y-estrangulamiento-de-la-api" class="md-nav__link">
    <span class="md-ellipsis">
      Límites y estrangulamiento de la API:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="integracion-de-abuseipdb-con-fail2ban">Integración de AbuseIPDB con Fail2Ban</h1>
<h2 id="denuncia-automatica-de-ips-maliciosas">Denuncia automática de IPs maliciosas</h2>
<p><strong>AbuseIPDB ofrece una API gratuita para denunciar y comprobar direcciones IP</strong>. Todos los días, webmasters, administradores de sistemas y otros profesionales de TI utilizan nuestra API para denunciar en tiempo real miles de direcciones IP comprometidas con el spam, el hacking, el escaneo de vulnerabilidades y otras actividades maliciosas.</p>
<p><strong>Fail2Ban</strong> es un <a href="https://github.com/fail2ban/fail2ban">software de código abierto</a> que escanea archivos de registro como /var/log/auth.log y bloquea las direcciones IP que tienen demasiados intentos fallidos de inicio de sesión. Para ello, actualiza las reglas del cortafuegos del sistema para rechazar nuevas conexiones desde esas direcciones IP durante un periodo de tiempo configurable. También puede detectar y bloquear IPs implicadas en intentos de exploits web, portscanning y otras actividades abusivas.</p>
<p>En este tutorial, aprenderemos a integrar Fail2Ban con tu cuenta de AbuseIPDB para que los intentos de intrusión contra tu sistema sean reportados automáticamente a través de la API de AbuseIPDB, ayudando a contribuir a la base de datos distribuida de amenazas IP de <a href="">AbuseIPDB</a>. Si ya tienes instalada la última versión de Fail2Ban, ¡sólo te llevará unos minutos!</p>
<h2 id="tutorial-de-integracion-de-abuseipdb-fail2ban">Tutorial de integración de AbuseIPDB + Fail2Ban</h2>
<ol>
<li>Requisitos previos - Antes de comenzar este tutorial</li>
<li>Verifique que la Acción de Denuncia de AbuseIPDB de Fail2Ban esté instalada</li>
<li>Activación de la acción de informe de abuso de IPDB de Fail2Ban</li>
<li>Solución de problemas</li>
</ol>
<h2 id="requisitos-previos-antes-de-empezar-este-tutorial">Requisitos previos - Antes de empezar este tutorial</h2>
<ol>
<li>
<p>Instale Fail2Ban en su servidor</p>
<p>Antes de comenzar este tutorial, asumimos que dispone de un servidor Linux con el sistema de detección de intrusos Fail2Ban instalado. Fail2Ban es software libre disponible en <a href="https://github.com/fail2ban/">https://github.com/fail2ban/fail2ban</a>. </p>
<p>Por favor, consulta la <a href="http://www.fail2ban.org/wiki/index.php/MANUAL_0_8">documentación de Fail2Ban</a> o el <a href="https://www.digitalocean.com/community/tutorials/how-to-protect-ssh-with-fail2ban-on-centos-7">tutorial de instalación de Fail2Ban de DigitalOcean</a> para instalar Fail2Ban y establecer la configuración básica de la jaula para detectar intentos de intrusión en SSH, Apache, etc.</p>
</li>
<li>
<p>Crear una clave API AbuseIPDB
    También asumimos que tienes una cuenta registrada en AbuseIPDB, y que has verificado tu dominio y creado una <a href="https://www.abuseipdb.com/account">clave API</a>. El uso de la API es gratuito, pero tienes que <a href="https://www.abuseipdb.com/register">crear una cuenta</a>.</p>
</li>
</ol>
<h2 id="compruebe-que-la-accion-de-denuncia-de-abusos-de-fail2banipdb-esta-instalada">Compruebe que la acción de denuncia de abusos de Fail2BanIPDB está instalada</h2>
<p>La habilidad de reportar IPs abusivas directamente a AbuseIPDB fue añadida al repositorio maestro de Fail2Ban en v0.10.0 (Enero 2017). Si tienes una versión anterior de Fail2Ban instalada en tu servidor, tendrás que actualizar Fail2Ban o instalar tú mismo el archivo de acción abuseipdb.conf. Para comprobar qué versión de Fail2Ban tienes instalada, ejecuta el siguiente comando:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>fail2ban-client<span class="w"> </span>-V
</code></pre></div>
<p>Puedes verificar que tu instalación de Fail2Ban soporta AbuseIPDB comprobando que el archivo de configuración de acciones /etc/fail2ban/action.d/abuseipdb.conf existe. Si no existe, puedes añadirlo manualmente copiando el último archivo de configuración de <a href="https://github.com/fail2ban/fail2ban/blob/0.11/config/action.d/abuseipdb.conf">Fail2Ban Github</a>.</p>
<p>Tu archivo <strong><em>/etc/fail2ban/jail.local</em></strong> (la versión personalizable de jail.conf) también debería contener la siguiente definición para "action_abuseipdb":</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a># Report ban via abuseipdb.com.
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>#
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a># See action.d/abuseipdb.conf for usage example and details.
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>#
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>action_abuseipdb = abuseipdb
</code></pre></div>
<p>Si este código de definición de acción no existe, añádelo a tu jail.local antes de la línea <code>action = %(action_)s</code>. ¡Eso es todo lo que necesitas para soportar la acción AbuseIPDB Fail2Ban!</p>
<h3 id="que-hara-la-accion-abuseipdb">¿Qué hará la acción AbuseIPDB?</h3>
<p>La acción AbuseIPDB hará que la dirección IP que desencadenó un jail de Fail2Ban sea reportada automáticamente a la API de AbuseIPDB a través de un comando cURL. Por defecto, este informe incluirá el fragmento del archivo de registro que activó el bloqueo de Fail2Ban en el campo de comentarios del informe. El comentario puede ser modificado o desactivado buscando el fragmento '<strong>comment=<matches></strong>' en <strong><em>action.d/abuseipdb.conf</em></strong> de la siguiente manera:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>actionban = curl --tlsv1.0 --fail &#39;https://api.abuseipdb.com/api/v2/report&#39; \
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>    -H &#39;Accept: application/json&#39; \
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>    -H &#39;Key: &lt;abuseipdb_apikey&gt;&#39; \
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    --data-urlencode &#39;ip=&lt;ip&gt;&#39; \
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>    --data-urlencode &#39;comment=&lt;matches&gt;&#39; \
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>    --data &#39;categories=&lt;abuseipdb_category&gt;&#39;
</code></pre></div>
<h2 id="activar-la-accion-de-denuncia-de-abuseipdb">Activar la acción de denuncia de AbuseIPDB</h2>
<p>Puedes invocar la acción AbuseIPDB desde algunas o todas las cárceles configuradas en jail.local. La acción debe ser invocada con dos parámetros - <a href="https://www.abuseipdb.com/account">tu clave API AbuseIPDB</a>, y la <a href="https://www.abuseipdb.com/categories">categoría de abuso (o categorías)</a> por la que quieres reportar la IP. Si estos parámetros faltan o no son válidos, tus reportes fallarán.</p>
<p><code>%(action_abuseipdb)s[abuseipdb_apikey="my-api-key", abuseipdb_category="18,22"]</code></p>
<p>Esta línea de código debe añadirse a cada jaula para la que quieras activar los informes de AbuseIPDB. A continuación se muestra un ejemplo de cómo configurar la acción de informe de AbuseIPDB para que se ejecute, además de las acciones de bloqueo predeterminadas, cuando se activa la jaula de fuerza bruta sshd:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>[sshd]
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>enabled = true
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a># To use more aggressive sshd modes set filter parameter &quot;mode&quot; in jail.local:
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a># normal (default), ddos, extra or aggressive (combines all).
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a># See &quot;tests/files/logs/sshd&quot; or &quot;filter.d/sshd.conf&quot; for usage example and details.
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>#mode   = normal
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>port    = ssh
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>logpath = %(sshd_log)s
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>backend = %(sshd_backend)s
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a># Ban IP and report to AbuseIPDB for SSH Brute-Forcing
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>action = %(action_)s
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>         %(action_abuseipdb)s[abuseipdb_apikey=&quot;my-api-key&quot;, abuseipdb_category=&quot;18,22&quot;]
</code></pre></div>
<p>Le recomendamos que añada la acción AbuseIPDB individualmente a sus jaulas para que pueda personalizar las <a href="https://www.abuseipdb.com/categories">categorías del informe AbuseIPDB</a> y hacer sus informes más específicos. Sin embargo, la acción AbuseIPDB también se puede añadir a la lista de acciones Fail2Ban en el global [DEFAULT] como se muestra a continuación, lo que hará que se ejecute en todas las jaulas sin una acción especificada:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a># Choose default action.  To change, just override value of &#39;action&#39; with the
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a># interpolation to the chosen action shortcut (e.g.  action_mw, action_mwl, etc) in jail.local
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a># globally (section [DEFAULT]) or per specific section
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>action = %(action_)s
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>         %(action_abuseipdb)s[abuseipdb_apikey=&quot;my-api-key&quot;, abuseipdb_category=&quot;18&quot;]
</code></pre></div>
<p>A continuación encontrará una tabla con algunas de las <a href="https://www.abuseipdb.com/categories">categorías de informes</a> más populares de AbuseIPDB para personalizar sus informes:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a>FTP Brute-Force     Port Scan   Hacking  Brute-Force    Bad Web Bot     SSH     Web App Attack
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>     5                 14         15         18              19          22         21
</code></pre></div>
<p>Una vez que haya actualizado la configuración de jail.local, guarde el archivo y reinicie o recargue el servicio Fail2Ban para asegurarse de que su configuración funciona:</p>
<p><code>fail2ban-client reload</code></p>
<p>Si tu configuración es correcta, Fail2Ban debería empezar a ejecutar la acción AbuseIPDB cada vez que una nueva IP es baneada. Inicia sesión y revisa tu <a href="https://www.abuseipdb.com/account/reports">página de IPs reportadas</a>, ¡y observa como Fail2Ban comienza a reportar automáticamente IPs a AbuseIPDB bajo tu cuenta!</p>
<h2 id="solucion-de-problemas">Solución de problemas</h2>
<p>Si los informes no se transmiten automáticamente a su cuenta, compruebe el archivo de registro de Fail2Ban con sudo <code>less /var/log/fail2ban.log</code>. Puedes verificar que las IPs están siendo baneadas correctamente por tus jaulas, y comprobar si hay errores cURL que puedan estar causando que tus informes fallen.</p>
<h3 id="errores-en-la-clave-y-los-parametros-de-la-api">Errores en la clave y los parámetros de la API:</h3>
<p>Los problemas con el envío de la API, como una clave de API no válida o categorías no válidas, pueden no aparecer como error en el archivo de registro de Fail2Ban. Debe verificar que sus parámetros son correctos consultando la <a href="https://www.abuseipdb.com/api.html">documentación de la API</a> y ejecutando un informe de prueba a través de la API. Los informes de prueba pueden ser borrados en su <a href="https://www.abuseipdb.com/account/reports">página de IPs reportadas</a>.</p>
<h3 id="limites-y-estrangulamiento-de-la-api">Límites y estrangulamiento de la API:</h3>
<p>Por defecto, los límites de uso de la API están limitados a 1.000 informes por día. Estos límites se incrementan a 3.000 para webmasters verificados y a 5.000 para <a href="https://www.abuseipdb.com/account/contributor">colaboradores</a>, lo que es muy recomendable para los usuarios de Fail2Ban (especialmente si tiene Fail2Ban funcionando en varios servidores informando a la misma clave API).</p>
<p>También impedimos que la misma IP sea reportada más de una vez cada 15 minutos para evitar reportes duplicados. Le recomendamos que aumente su configuración de <code>bantime</code> para evitar que estas IPs malas ataquen repetidamente su sistema. Un valor de 900 (15 minutos en segundos) le prevendrá de golpear nuestra ventana de 15 minutos.</p>
<ul>
<li><strong>Nota: si tiene previsto establecer la opción de configuración</strong> <code>findtime</code> <strong>para una jaula, no supere los 60 días (5.184.000 segundos).</strong> * Esto se ajusta a nuestra <a href="https://www.abuseipdb.com/reporting-policy">política de informes</a>.</li>
</ul>
<p><strong>Informes duplicados al reiniciar:</strong></p>
<p>Cada vez que Fail2Ban se reinicia, llama a la función <code>actionban</code> para cada IP almacenada en el archivo de base de datos. Esto causa reportes duplicados a AbuseIPDB. Si reinicias tu servidor a menudo, tenemos un script que evitará que esto ocurra.</p>
<ol>
<li>
<p>Cree el archivo <strong>abuseipdb-fail2ban-report.sh</strong></p>
<p>Introduzca <code>touch abuseipdb-fail2ban-report.sh</code> en su terminal.</p>
</li>
<li>
<p>Copie el siguiente código en el archivo creado, actualizando la ruta al archivo <code>REPORTED_IP_LIST_FILE</code> si es necesario</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a>#!/bin/bash
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>REPORTED_IP_LIST_FILE=/home/pi/abuseipdb-reported-ip-list
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>FAIL2BAN_SQLITE_DB=/var/lib/fail2ban/fail2ban.sqlite3
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>APIKEY=$1
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>COMMENT=$2
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>IP=$3
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a>CATEGORIES=$4
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a>BANTIME=$5
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a>ipMatch=`grep -Fe &quot;IP=$IP L=[0-9\-]+&quot; $REPORTED_IP_LIST_FILE`
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a>
<a id="__codelineno-6-14" name="__codelineno-6-14" href="#__codelineno-6-14"></a>shouldBanIP=1
<a id="__codelineno-6-15" name="__codelineno-6-15" href="#__codelineno-6-15"></a>currentTimestamp=`date +%s`
<a id="__codelineno-6-16" name="__codelineno-6-16" href="#__codelineno-6-16"></a>
<a id="__codelineno-6-17" name="__codelineno-6-17" href="#__codelineno-6-17"></a>if [ -z $ipMatch ] ; then
<a id="__codelineno-6-18" name="__codelineno-6-18" href="#__codelineno-6-18"></a>    banLength=`echo $ipMatch | sed -E &#39;s/.*L=([0-9\-]+)/\1/&#39;`
<a id="__codelineno-6-19" name="__codelineno-6-19" href="#__codelineno-6-19"></a>    timeOfBan=`sqlite3 $FAIL2BAN_SQLITE_DB &quot;SELECT timeofban FROM bans WHERE ip = &#39;$IP&#39;&quot;`
<a id="__codelineno-6-20" name="__codelineno-6-20" href="#__codelineno-6-20"></a>
<a id="__codelineno-6-21" name="__codelineno-6-21" href="#__codelineno-6-21"></a>    if (((banLength == -1 &amp;&amp; banLength == BANTIME) || (timeOfBan &gt; 0 &amp;&amp; timeOfBan + banLength &gt; currentTimestamp))) ; then
<a id="__codelineno-6-22" name="__codelineno-6-22" href="#__codelineno-6-22"></a>        shouldBanIP=0
<a id="__codelineno-6-23" name="__codelineno-6-23" href="#__codelineno-6-23"></a>    else
<a id="__codelineno-6-24" name="__codelineno-6-24" href="#__codelineno-6-24"></a>        sed -i &quot;/^IP=$IP.*$/d&quot; $REPORTED_IP_LIST_FILE
<a id="__codelineno-6-25" name="__codelineno-6-25" href="#__codelineno-6-25"></a>    fi
<a id="__codelineno-6-26" name="__codelineno-6-26" href="#__codelineno-6-26"></a>fi
<a id="__codelineno-6-27" name="__codelineno-6-27" href="#__codelineno-6-27"></a>
<a id="__codelineno-6-28" name="__codelineno-6-28" href="#__codelineno-6-28"></a>if [ $shouldBanIP -eq 1 ] ; then
<a id="__codelineno-6-29" name="__codelineno-6-29" href="#__codelineno-6-29"></a>    echo &quot;IP=$IP L=$BANTIME&quot; &gt;&gt; $REPORTED_IP_LIST_FILE
<a id="__codelineno-6-30" name="__codelineno-6-30" href="#__codelineno-6-30"></a>    curl --fail &#39;https://api.abuseipdb.com/api/v2/report&#39; \
<a id="__codelineno-6-31" name="__codelineno-6-31" href="#__codelineno-6-31"></a>        -H &#39;Accept: application/json&#39; \
<a id="__codelineno-6-32" name="__codelineno-6-32" href="#__codelineno-6-32"></a>        -H &quot;Key: $APIKEY&quot; \
<a id="__codelineno-6-33" name="__codelineno-6-33" href="#__codelineno-6-33"></a>        --data-urlencode &quot;comment=$COMMENT&quot; \
<a id="__codelineno-6-34" name="__codelineno-6-34" href="#__codelineno-6-34"></a>        --data-urlencode &quot;ip=$IP&quot; \
<a id="__codelineno-6-35" name="__codelineno-6-35" href="#__codelineno-6-35"></a>        --data &quot;categories=$CATEGORIES&quot;
<a id="__codelineno-6-36" name="__codelineno-6-36" href="#__codelineno-6-36"></a>fi
</code></pre></div>
</li>
<li>
<p>Convertir el archivo en ejecutable</p>
<p>Escribe <code>chmod +x abuseipdb-fail2ban-report.sh</code> en tu terminal</p>
</li>
<li>
<p>Modifica <code>/etc/fail2ban/action.d/abuseipdb.conf</code> <code>actionban</code> para que sea lo siguiente:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a>actionban = /path/to/file/abuseipdb-fail2ban-report.sh \
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>&quot;&lt;abuseipdb_apikey&gt;&quot; &quot;&lt;matches&gt;&quot; &quot;&lt;ip&gt;&quot; &quot;&lt;abuseipdb_category&gt;&quot; &quot;&lt;bantime&gt;&quot;
</code></pre></div>
</li>
<li>
<p>Cambia la línea <code>%(action_abuseipdb)s[abuseipdb_apikey="my-api-key", abuseipdb_category="18,22"]</code> en tu <strong>jail.local</strong> por:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>%(action_abuseipdb)s[abuseipdb_apikey=&quot;my-api-key&quot;, abuseipdb_category=&quot;18,22&quot;, bantime=&quot;%(bantime)s&quot;]
</code></pre></div>
<p>Para cada jaula a la que desee que se aplique.</p>
</li>
<li>
<p>Reinicie Fail2Ban usando </p>
<p><code>fail2ban-client reload</code></p>
</li>
</ol>







  
  



  



  <form class="md-feedback" name="feedback" hidden>
    <fieldset>
      <legend class="md-feedback__title">
        ¿Te ha resultado útil esta página?
      </legend>
      <div class="md-feedback__inner">
        <div class="md-feedback__list">
          
            <button class="md-feedback__icon md-icon" type="submit" title="¿Te ha resultado útil esta página?" data-md-value="1">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M5 9v12H1V9h4m4 12a2 2 0 0 1-2-2V9c0-.55.22-1.05.59-1.41L14.17 1l1.06 1.06c.27.27.44.64.44 1.05l-.03.32L14.69 8H21a2 2 0 0 1 2 2v2c0 .26-.05.5-.14.73l-3.02 7.05C19.54 20.5 18.83 21 18 21H9m0-2h9.03L21 12v-2h-8.79l1.13-5.32L9 9.03V19Z"/></svg>
            </button>
          
            <button class="md-feedback__icon md-icon" type="submit" title="Esta página podría mejorarse" data-md-value="0">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 15V3h4v12h-4M15 3a2 2 0 0 1 2 2v10c0 .55-.22 1.05-.59 1.41L9.83 23l-1.06-1.06c-.27-.27-.44-.64-.44-1.06l.03-.31.95-4.57H3a2 2 0 0 1-2-2v-2c0-.26.05-.5.14-.73l3.02-7.05C4.46 3.5 5.17 3 6 3h9m0 2H5.97L3 12v2h8.78l-1.13 5.32L15 14.97V5Z"/></svg>
            </button>
          
        </div>
        <div class="md-feedback__note">
          
            <div data-md-value="1" hidden>
              
              
                
              
              Gracias por sus comentarios.
            </div>
          
            <div data-md-value="0" hidden>
              
              
                
              
              Gracias por sus comentarios. Ayúdenos a mejorar esta página utilizando nuestro <a href="..." target="_blank" rel="noopener">formulario de comentarios</a>.
            </div>
          
        </div>
      </div>
    </fieldset>
  </form>


                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../api/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Documentación de la API - AbuseIPDB">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Documentación de la API - AbuseIPDB
              </div>
            </div>
          </a>
        
        
          
          <a href="../docs/introduccion/" class="md-footer__link md-footer__link--next" aria-label="Next: Introducción">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Introducción
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 <a href="https://github.com/terracenter target="_blank" rel="noopener"> Freddy Taborda </a>
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/terracenter" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/terracenter0" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/in/freddy-taborda-5199802a/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["content.code.copy", "navigation.footer", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.progress", "navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "navigation.path", "navigation.prune", "navigation.indexes", "toc.follow", "navigation.top", "search.suggest", "search.highlight", "search.share"], "search": "../../../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.1e8ae164.min.js"></script>
      
    
  </body>
</html>